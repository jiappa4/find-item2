<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ê²© ë¹„êµ ë„êµ¬ - ìµœì €ê°€ ì°¾ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-500 to-purple-700 min-h-screen p-6">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="text-center text-white mb-8">
            <h1 class="text-4xl font-bold mb-2">ğŸ” ê°€ê²© ë¹„êµ ë„êµ¬</h1>
            <p class="text-lg opacity-90">ì§ì ‘ ê°€ê²©ì„ ì…ë ¥í•˜ì—¬ ìµœì €ê°€ë¥¼ ë¹„êµí•˜ì„¸ìš”</p>
        </div>

        <!-- Search Card -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
            <div class="flex gap-4 mb-4 flex-wrap">
                <input
                    type="text"
                    id="searchQuery"
                    class="flex-1 min-w-[300px] px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none text-lg"
                    placeholder="ê²€ìƒ‰í•  ìƒí’ˆëª… ì…ë ¥ (ì˜ˆ: ì‹ ì¼ íŒ¬íˆí„° 1200)"
                    value="ì‹ ì¼ íŒ¬íˆí„° 1200"
                />
                <button
                    onclick="openShoppingSearch()"
                    class="px-8 py-3 bg-gradient-to-r from-purple-500 to-purple-700 text-white rounded-lg font-semibold hover:shadow-lg transition"
                >
                    ğŸ›’ ì‡¼í•‘ëª° ì—´ê¸°
                </button>
                <button
                    onclick="toggleAddForm()"
                    id="addBtn"
                    class="px-8 py-3 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition"
                >
                    â• ì¶”ê°€
                </button>
            </div>
            
            <div class="flex items-center gap-2 text-sm text-gray-600 bg-blue-50 p-3 rounded-lg">
                <span>ğŸ’¡</span>
                <p><strong>ì‚¬ìš©ë²•:</strong> "ì‡¼í•‘ëª° ì—´ê¸°" ë²„íŠ¼ìœ¼ë¡œ ê° ì‚¬ì´íŠ¸ë¥¼ í™•ì¸í•œ í›„, ê°€ê²©ì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”</p>
            </div>

            <!-- Add Product Form -->
            <div id="addForm" class="hidden mt-6 p-6 bg-gray-50 rounded-lg border-2 border-purple-200 fade-in">
                <h3 class="text-lg font-bold mb-4">ìƒí’ˆ ì¶”ê°€í•˜ê¸°</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="text" id="shop" placeholder="ì‡¼í•‘ëª° (ì˜ˆ: ë„¤ì´ë²„ì‡¼í•‘)" class="px-4 py-2 border rounded-lg focus:border-purple-500 focus:outline-none" />
                    <input type="text" id="name" placeholder="ìƒí’ˆëª…" class="px-4 py-2 border rounded-lg focus:border-purple-500 focus:outline-none" />
                    <input type="text" id="option" placeholder="ì˜µì…˜ (ì„ íƒ)" value="ë‹¨ì¼" class="px-4 py-2 border rounded-lg focus:border-purple-500 focus:outline-none" />
                    <input type="number" id="originalPrice" placeholder="ì •ê°€ (ì„ íƒ)" class="px-4 py-2 border rounded-lg focus:border-purple-500 focus:outline-none" />
                    <input type="number" id="discountPrice" placeholder="í• ì¸ê°€ (í•„ìˆ˜)" class="px-4 py-2 border rounded-lg focus:border-purple-500 focus:outline-none" />
                    <input type="number" id="shipping" placeholder="ë°°ì†¡ë¹„ (ë¬´ë£Œë©´ 0)" value="0" class="px-4 py-2 border rounded-lg focus:border-purple-500 focus:outline-none" />
                    <input type="text" id="link" placeholder="ë§í¬ (ì„ íƒ)" class="px-4 py-2 border rounded-lg col-span-full focus:border-purple-500 focus:outline-none" />
                </div>
                <button
                    onclick="addProduct()"
                    class="mt-4 w-full py-3 bg-purple-500 text-white rounded-lg font-semibold hover:bg-purple-600 transition"
                >
                    ì¶”ê°€í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- Summary -->
        <div id="summary" class="hidden bg-white rounded-2xl shadow-xl p-6 mb-6 fade-in">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="text-center">
                    <div class="text-sm text-gray-600 mb-1">ìµœì €ì‹¤í˜„ê°€</div>
                    <div id="lowestPrice" class="text-2xl font-bold text-purple-600">-</div>
                </div>
                <div class="text-center">
                    <div class="text-sm text-gray-600 mb-1">í‰ê·  ê°€ê²©</div>
                    <div id="avgPrice" class="text-2xl font-bold text-purple-600">-</div>
                </div>
                <div class="text-center">
                    <div class="text-sm text-gray-600 mb-1">ë“±ë¡ ìƒí’ˆ</div>
                    <div id="totalCount" class="text-2xl font-bold text-purple-600">0ê°œ</div>
                </div>
                <div class="text-center">
                    <div class="text-sm text-gray-600 mb-1">ë¬´ë£Œë°°ì†¡</div>
                    <div id="freeShipping" class="text-2xl font-bold text-purple-600">0%</div>
                </div>
            </div>
        </div>

        <!-- Results -->
        <div id="resultsContainer" class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div id="emptyState" class="p-16 text-center">
                <div class="text-6xl mb-4">ğŸ“</div>
                <h3 class="text-2xl font-bold text-gray-700 mb-2">ìƒí’ˆì„ ì¶”ê°€í•´ì£¼ì„¸ìš”</h3>
                <p class="text-gray-500">
                    "ì‡¼í•‘ëª° ì—´ê¸°" ë²„íŠ¼ìœ¼ë¡œ ê°€ê²©ì„ í™•ì¸í•œ í›„<br/>
                    "â• ì¶”ê°€" ë²„íŠ¼ìœ¼ë¡œ ìƒí’ˆì„ ë“±ë¡í•˜ì„¸ìš”
                </p>
            </div>

            <div id="resultsTable" class="hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gradient-to-r from-purple-500 to-purple-700 text-white">
                            <tr>
                                <th class="px-4 py-3 text-left">ìˆœìœ„</th>
                                <th class="px-4 py-3 text-left">ì‡¼í•‘ëª°</th>
                                <th class="px-4 py-3 text-left">ìƒí’ˆëª…</th>
                                <th class="px-4 py-3 text-left">ì˜µì…˜</th>
                                <th class="px-4 py-3 text-left">ì •ê°€</th>
                                <th class="px-4 py-3 text-left">í• ì¸ê°€</th>
                                <th class="px-4 py-3 text-left">ë°°ì†¡ë¹„</th>
                                <th class="px-4 py-3 text-left">ìµœì €ì‹¤í˜„ê°€</th>
                                <th class="px-4 py-3 text-left">ë§í¬</th>
                                <th class="px-4 py-3 text-left">ì‚­ì œ</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>

                <div class="p-6 bg-gray-50">
                    <h3 class="text-lg font-bold mb-3">ğŸ“Š ë¶„ì„ ìš”ì•½</h3>
                    <ul id="analysisText" class="space-y-2 text-gray-700">
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let products = [];

        function formatPrice(price) {
            if (!price) return '0ì›';
            return parseInt(price).toLocaleString('ko-KR') + 'ì›';
        }

        function getRankBadge(index) {
            const colors = ['#FFD700', '#C0C0C0', '#CD7F32', '#667eea'];
            const color = colors[Math.min(index, 3)];
            return `<div class="flex items-center justify-center w-8 h-8 rounded-full text-white font-bold" style="background: ${color}">${index + 1}</div>`;
        }

        function openShoppingSearch() {
            const query = document.getElementById('searchQuery').value;
            if (!query.trim()) {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            const shops = [
                `ë„¤ì´ë²„ì‡¼í•‘ ${query}`,
                `ì¿ íŒ¡ ${query}`,
                `11ë²ˆê°€ ${query}`,
                `Gë§ˆì¼“ ${query}`,
                `ì˜¥ì…˜ ${query}`
            ];

            shops.forEach(shop => {
                window.open(`https://search.naver.com/search.naver?query=${encodeURIComponent(shop)}`, '_blank');
            });
        }

        function toggleAddForm() {
            const form = document.getElementById('addForm');
            const btn = document.getElementById('addBtn');
            const isHidden = form.classList.contains('hidden');
            
            if (isHidden) {
                form.classList.remove('hidden');
                btn.textContent = 'âŒ ì·¨ì†Œ';
                btn.classList.remove('bg-green-500', 'hover:bg-green-600');
                btn.classList.add('bg-red-500', 'hover:bg-red-600');
            } else {
                form.classList.add('hidden');
                btn.textContent = 'â• ì¶”ê°€';
                btn.classList.remove('bg-red-500', 'hover:bg-red-600');
                btn.classList.add('bg-green-500', 'hover:bg-green-600');
            }
        }

        function addProduct() {
            const shop = document.getElementById('shop').value;
            const name = document.getElementById('name').value;
            const option = document.getElementById('option').value || 'ë‹¨ì¼';
            const originalPrice = parseInt(document.getElementById('originalPrice').value) || 0;
            const discountPrice = parseInt(document.getElementById('discountPrice').value);
            const shipping = parseInt(document.getElementById('shipping').value) || 0;
            const link = document.getElementById('link').value;

            if (!shop || !name || !discountPrice) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!\n(ì‡¼í•‘ëª°, ìƒí’ˆëª…, í• ì¸ê°€)');
                return;
            }

            const product = {
                shop,
                name,
                option,
                originalPrice: originalPrice || discountPrice,
                discountPrice,
                shipping,
                finalPrice: discountPrice + shipping,
                link
            };

            products.push(product);
            products.sort((a, b) => a.finalPrice - b.finalPrice);

            // Clear form
            document.getElementById('shop').value = '';
            document.getElementById('name').value = '';
            document.getElementById('option').value = 'ë‹¨ì¼';
            document.getElementById('originalPrice').value = '';
            document.getElementById('discountPrice').value = '';
            document.getElementById('shipping').value = '0';
            document.getElementById('link').value = '';

            toggleAddForm();
            renderResults();
        }

        function deleteProduct(index) {
            if (confirm('ì´ ìƒí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                products.splice(index, 1);
                renderResults();
            }
        }

        function renderResults() {
            if (products.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
                document.getElementById('resultsTable').classList.add('hidden');
                document.getElementById('summary').classList.add('hidden');
                return;
            }

            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('resultsTable').classList.remove('hidden');
            document.getElementById('summary').classList.remove('hidden');

            // Update summary
            const avgPrice = Math.round(products.reduce((sum, p) => sum + p.finalPrice, 0) / products.length);
            const freeShippingCount = products.filter(p => p.shipping === 0).length;
            const freeShippingRate = Math.round((freeShippingCount / products.length) * 100);

            document.getElementById('lowestPrice').textContent = formatPrice(products[0].finalPrice);
            document.getElementById('avgPrice').textContent = formatPrice(avgPrice);
            document.getElementById('totalCount').textContent = products.length + 'ê°œ';
            document.getElementById('freeShipping').textContent = freeShippingRate + '%';

            // Render table
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = products.map((item, index) => `
                <tr class="border-b hover:bg-gray-50 fade-in">
                    <td class="px-4 py-3">${getRankBadge(index)}</td>
                    <td class="px-4 py-3">
                        <span class="px-3 py-1 bg-gray-100 rounded-full text-sm font-semibold">
                            ${item.shop}
                        </span>
                    </td>
                    <td class="px-4 py-3 font-medium">${item.name}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${item.option}</td>
                    <td class="px-4 py-3 text-gray-400 line-through text-sm">
                        ${formatPrice(item.originalPrice)}
                    </td>
                    <td class="px-4 py-3 text-pink-600 font-semibold">
                        ${formatPrice(item.discountPrice)}
                    </td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 rounded text-xs font-semibold ${
                            item.shipping === 0 ? 'bg-green-500 text-white' : 'bg-orange-500 text-white'
                        }">
                            ${item.shipping === 0 ? 'ë¬´ë£Œ' : formatPrice(item.shipping)}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-purple-600 font-bold text-lg">
                        ${formatPrice(item.finalPrice)}
                    </td>
                    <td class="px-4 py-3">
                        ${item.link ? `
                            <a href="${item.link}" target="_blank" rel="noopener noreferrer"
                               class="px-3 py-1 bg-purple-500 text-white rounded text-sm hover:bg-purple-600">
                                ì´ë™
                            </a>
                        ` : '<span class="text-gray-400 text-sm">-</span>'}
                    </td>
                    <td class="px-4 py-3">
                        <button onclick="deleteProduct(${index})"
                                class="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">
                            ì‚­ì œ
                        </button>
                    </td>
                </tr>
            `).join('');

            // Render analysis
            const priceDiff = products[products.length - 1].finalPrice - products[0].finalPrice;
            document.getElementById('analysisText').innerHTML = `
                <li><strong>ìµœì €ì‹¤í˜„ê°€:</strong> ${products[0].shop}ì—ì„œ ${formatPrice(products[0].finalPrice)}</li>
                <li><strong>ê°€ê²© ë²”ìœ„:</strong> ${formatPrice(products[0].finalPrice)} ~ ${formatPrice(products[products.length - 1].finalPrice)}</li>
                <li><strong>ê°€ê²© ì°¨ì´:</strong> ${formatPrice(priceDiff)}</li>
                <li><strong>ë¬´ë£Œë°°ì†¡:</strong> ${freeShippingCount}ê°œ / ${products.length}ê°œ</li>
            `;
        }

        // Initialize
        renderResults();
    </script>
</body>
</html>